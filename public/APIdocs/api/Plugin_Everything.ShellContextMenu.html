<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
      <title>Class ShellContextMenu | QuokkaDocs </title>
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <meta name="title" content="Class ShellContextMenu | QuokkaDocs ">
      
      <meta name="description" content="&amp;quot;Stand-alone&amp;quot; shell context menu Create an instance and call ShowContextMenu with a list of FileInfo for the files. Limitation is that it only handles files in the same directory but it can be fixed by changing the way files are translated into PIDLs. Based on FileBrowser in C# from CodeProject http://www.codeproject.com/useritems/FileBrowser.asp Hooking class taken from MSDN Magazine Cutting Edge column http://msdn.microsoft.com/msdnmag/issues/02/10/CuttingEdge/ Andreas Johansson afjohansson http://afjohansson.spaces.live.com">
      <link rel="icon" href="../../assets/media/QuokkaLogo.svg">
      <link rel="stylesheet" href="../public/docfx.min.css">
      <link rel="stylesheet" href="../public/main.css">
      <meta name="docfx:navrel" content="../toc.html">
      <meta name="docfx:tocrel" content="toc.html">
      
      <meta name="docfx:rel" content="../">
      <meta name="docfx:disablenewtab" content="true">
      
      
      <meta name="loc:inThisArticle" content="In this article">
      <meta name="loc:searchResultsCount" content="{count} results for &quot;{query}&quot;">
      <meta name="loc:searchNoResults" content="No results for &quot;{query}&quot;">
      <meta name="loc:tocFilter" content="Filter by title">
      <meta name="loc:nextArticle" content="Next">
      <meta name="loc:prevArticle" content="Previous">
      <meta name="loc:themeLight" content="Light">
      <meta name="loc:themeDark" content="Dark">
      <meta name="loc:themeAuto" content="Auto">
      <meta name="loc:changeTheme" content="Change theme">
      <meta name="loc:copy" content="Copy">
      <meta name="loc:downloadPdf" content="Download PDF">

      <script type="module" src="./../public/docfx.min.js"></script>

      <script>
        const theme = localStorage.getItem('theme') || 'auto'
        document.documentElement.setAttribute('data-bs-theme', theme === 'auto' ? (window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light') : theme)
      </script>

  </head>

  <body class="tex2jax_ignore" data-layout="" data-yaml-mime="ManagedReference">
    <header class="bg-body border-bottom">
      <nav id="autocollapse" class="navbar navbar-expand-md" role="navigation">
        <div class="container-xxl flex-nowrap">
          <a class="navbar-brand" href="../index.html">
            <img id="logo" class="svg" src="../../assets/media/QuokkaLogo.svg" alt="QuokkaDocs">
            QuokkaDocs
          </a>
          <button class="btn btn-lg d-md-none border-0" type="button" data-bs-toggle="collapse" data-bs-target="#navpanel" aria-controls="navpanel" aria-expanded="false" aria-label="Toggle navigation">
            <i class="bi bi-three-dots"></i>
          </button>
          <div class="collapse navbar-collapse" id="navpanel">
            <div id="navbar">
              <form class="search" role="search" id="search">
                <i class="bi bi-search"></i>
                <input class="form-control" id="search-query" type="search" disabled="" placeholder="Search" autocomplete="off" aria-label="Search">
              </form>
            </div>
          </div>
        </div>
      </nav>
    </header>

    <main class="container-xxl">
      <div class="toc-offcanvas">
        <div class="offcanvas-md offcanvas-start" tabindex="-1" id="tocOffcanvas" aria-labelledby="tocOffcanvasLabel">
          <div class="offcanvas-header">
            <h5 class="offcanvas-title" id="tocOffcanvasLabel">Table of Contents</h5>
            <button type="button" class="btn-close" data-bs-dismiss="offcanvas" data-bs-target="#tocOffcanvas" aria-label="Close"></button>
          </div>
          <div class="offcanvas-body">
            <nav class="toc" id="toc"></nav>
          </div>
        </div>
      </div>

      <div class="content">
        <div class="actionbar">
          <button class="btn btn-lg border-0 d-md-none" type="button" data-bs-toggle="offcanvas" data-bs-target="#tocOffcanvas" aria-controls="tocOffcanvas" aria-expanded="false" aria-label="Show table of contents">
            <i class="bi bi-list"></i>
          </button>

          <nav id="breadcrumb"></nav>
        </div>

        <article data-uid="Plugin_Everything.ShellContextMenu">



  <h1 id="Plugin_Everything_ShellContextMenu" data-uid="Plugin_Everything.ShellContextMenu" class="text-break">
Class ShellContextMenu  
  </h1>

  <div class="facts text-secondary">
    <dl><dt>Namespace</dt><dd><a class="xref" href="Plugin_Everything.html">Plugin_Everything</a></dd></dl>
  <dl><dt>Assembly</dt><dd>Plugin_Everything.dll</dd></dl>
  </div>

  <div class="markdown summary"><p>&quot;Stand-alone&quot; shell context menu</p>
<p>Create an instance and call ShowContextMenu with a list of FileInfo for the files.
Limitation is that it only handles files in the same directory but it can be fixed
by changing the way files are translated into PIDLs.</p>
<p>Based on FileBrowser in C# from CodeProject
<a href="http://www.codeproject.com/useritems/FileBrowser.asp">http://www.codeproject.com/useritems/FileBrowser.asp</a></p>
<p>Hooking class taken from MSDN Magazine Cutting Edge column
<a href="http://msdn.microsoft.com/msdnmag/issues/02/10/CuttingEdge/">http://msdn.microsoft.com/msdnmag/issues/02/10/CuttingEdge/</a></p>
<p>Andreas Johansson
afjohansson@hotmail.com
<a href="http://afjohansson.spaces.live.com">http://afjohansson.spaces.live.com</a></p>
</div>
  <div class="markdown conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public class ShellContextMenu : NativeWindow, IWin32Window</code></pre>
  </div>




  <dl class="typelist inheritance">
    <dt>Inheritance</dt>
    <dd>
      <div><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object">object</a></div>
      <div><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.marshalbyrefobject">MarshalByRefObject</a></div>
      <div><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.windows.forms.nativewindow">NativeWindow</a></div>
      <div><span class="xref">ShellContextMenu</span></div>
    </dd>
  </dl>

  <dl class="typelist implements">
    <dt>Implements</dt>
    <dd>
      <div><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.windows.forms.iwin32window">IWin32Window</a></div>
    </dd>
  </dl>


  <dl class="typelist inheritedMembers">
    <dt>Inherited Members</dt>
    <dd>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.windows.forms.nativewindow.assignhandle">NativeWindow.AssignHandle(IntPtr)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.windows.forms.nativewindow.createhandle">NativeWindow.CreateHandle(CreateParams)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.windows.forms.nativewindow.defwndproc">NativeWindow.DefWndProc(ref Message)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.windows.forms.nativewindow.destroyhandle">NativeWindow.DestroyHandle()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.windows.forms.nativewindow.fromhandle">NativeWindow.FromHandle(IntPtr)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.windows.forms.nativewindow.onhandlechange">NativeWindow.OnHandleChange()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.windows.forms.nativewindow.onthreadexception">NativeWindow.OnThreadException(Exception)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.windows.forms.nativewindow.releasehandle">NativeWindow.ReleaseHandle()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.windows.forms.nativewindow.handle">NativeWindow.Handle</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.marshalbyrefobject.memberwiseclone">MarshalByRefObject.MemberwiseClone(bool)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.marshalbyrefobject.getlifetimeservice">MarshalByRefObject.GetLifetimeService()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.marshalbyrefobject.initializelifetimeservice">MarshalByRefObject.InitializeLifetimeService()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.marshalbyrefobject.createobjref">MarshalByRefObject.CreateObjRef(Type)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.tostring">object.ToString()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object)">object.Equals(object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.equals#system-object-equals(system-object-system-object)">object.Equals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.referenceequals">object.ReferenceEquals(object, object)</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gethashcode">object.GetHashCode()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.gettype">object.GetType()</a>
    </div>
    <div>
      <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.object.memberwiseclone">object.MemberwiseClone()</a>
    </div>
  </dd></dl>



  <h2 id="Plugin_Everything_ShellContextMenu_examples">Examples</h2>
  <p>ShellContextMenu scm = new ShellContextMenu();<br>
FileInfo[] files = new FileInfo[1];<br>
files[0] = new FileInfo(@&quot;c:\windows\notepad.exe&quot;);<br>
scm.ShowContextMenu(this.Handle, files, Cursor.Position);<br></p>




  <h2 class="section" id="constructors">Constructors
</h2>


  <a id="Plugin_Everything_ShellContextMenu__ctor_" data-uid="Plugin_Everything.ShellContextMenu.#ctor*"></a>

  <h3 id="Plugin_Everything_ShellContextMenu__ctor" data-uid="Plugin_Everything.ShellContextMenu.#ctor">
  ShellContextMenu()
  
  </h3>

  <div class="markdown level1 summary"><p>Default constructor</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public ShellContextMenu()</code></pre>
  </div>













  <h2 class="section" id="methods">Methods
</h2>


  <a id="Plugin_Everything_ShellContextMenu_Finalize_" data-uid="Plugin_Everything.ShellContextMenu.Finalize*"></a>

  <h3 id="Plugin_Everything_ShellContextMenu_Finalize" data-uid="Plugin_Everything.ShellContextMenu.Finalize">
  ~ShellContextMenu()
  
  </h3>

  <div class="markdown level1 summary"><p>Ensure all resources get released</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">protected ~ShellContextMenu()</code></pre>
  </div>













  <a id="Plugin_Everything_ShellContextMenu_FreePIDLs_" data-uid="Plugin_Everything.ShellContextMenu.FreePIDLs*"></a>

  <h3 id="Plugin_Everything_ShellContextMenu_FreePIDLs_System_IntPtr___" data-uid="Plugin_Everything.ShellContextMenu.FreePIDLs(System.IntPtr[])">
  FreePIDLs(IntPtr[])
  
  </h3>

  <div class="markdown level1 summary"><p>Free the PIDLs</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">protected void FreePIDLs(IntPtr[] arrPIDLs)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>arrPIDLs</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.intptr">IntPtr</a>[]</dt>
    <dd><p>Array of PIDLs (IntPtr)</p>
</dd>
  </dl>












  <a id="Plugin_Everything_ShellContextMenu_GetPIDLs_" data-uid="Plugin_Everything.ShellContextMenu.GetPIDLs*"></a>

  <h3 id="Plugin_Everything_ShellContextMenu_GetPIDLs_System_IO_DirectoryInfo___" data-uid="Plugin_Everything.ShellContextMenu.GetPIDLs(System.IO.DirectoryInfo[])">
  GetPIDLs(DirectoryInfo[])
  
  </h3>

  <div class="markdown level1 summary"><p>Get the PIDLs</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">protected IntPtr[] GetPIDLs(DirectoryInfo[] arrFI)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>arrFI</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.io.directoryinfo">DirectoryInfo</a>[]</dt>
    <dd><p>Array of DirectoryInfo</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.intptr">IntPtr</a>[]</dt>
    <dd><p>Array of PIDLs</p>
</dd>
  </dl>











  <a id="Plugin_Everything_ShellContextMenu_GetPIDLs_" data-uid="Plugin_Everything.ShellContextMenu.GetPIDLs*"></a>

  <h3 id="Plugin_Everything_ShellContextMenu_GetPIDLs_System_IO_FileInfo___" data-uid="Plugin_Everything.ShellContextMenu.GetPIDLs(System.IO.FileInfo[])">
  GetPIDLs(FileInfo[])
  
  </h3>

  <div class="markdown level1 summary"><p>Get the PIDLs</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">protected IntPtr[] GetPIDLs(FileInfo[] arrFI)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>arrFI</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.io.fileinfo">FileInfo</a>[]</dt>
    <dd><p>Array of FileInfo</p>
</dd>
  </dl>

  <h4 class="section">Returns</h4>
  <dl class="parameters">
    <dt><a class="xref" href="https://learn.microsoft.com/dotnet/api/system.intptr">IntPtr</a>[]</dt>
    <dd><p>Array of PIDLs</p>
</dd>
  </dl>











  <a id="Plugin_Everything_ShellContextMenu_ShowContextMenu_" data-uid="Plugin_Everything.ShellContextMenu.ShowContextMenu*"></a>

  <h3 id="Plugin_Everything_ShellContextMenu_ShowContextMenu_System_IO_DirectoryInfo___System_Drawing_Point_" data-uid="Plugin_Everything.ShellContextMenu.ShowContextMenu(System.IO.DirectoryInfo[],System.Drawing.Point)">
  ShowContextMenu(DirectoryInfo[], Point)
  
  </h3>

  <div class="markdown level1 summary"><p>Shows the context menu</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public void ShowContextMenu(DirectoryInfo[] dirs, Point pointScreen)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>dirs</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.io.directoryinfo">DirectoryInfo</a>[]</dt>
    <dd><p>DirectoryInfos (should all be in same directory)</p>
</dd>
    <dt><code>pointScreen</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.drawing.point">Point</a></dt>
    <dd><p>Where to show the menu</p>
</dd>
  </dl>












  <a id="Plugin_Everything_ShellContextMenu_ShowContextMenu_" data-uid="Plugin_Everything.ShellContextMenu.ShowContextMenu*"></a>

  <h3 id="Plugin_Everything_ShellContextMenu_ShowContextMenu_System_IO_FileInfo___System_Drawing_Point_" data-uid="Plugin_Everything.ShellContextMenu.ShowContextMenu(System.IO.FileInfo[],System.Drawing.Point)">
  ShowContextMenu(FileInfo[], Point)
  
  </h3>

  <div class="markdown level1 summary"><p>Shows the context menu</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">public void ShowContextMenu(FileInfo[] files, Point pointScreen)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>files</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.io.fileinfo">FileInfo</a>[]</dt>
    <dd><p>FileInfos (should all be in same directory)</p>
</dd>
    <dt><code>pointScreen</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.drawing.point">Point</a></dt>
    <dd><p>Where to show the menu</p>
</dd>
  </dl>












  <a id="Plugin_Everything_ShellContextMenu_WndProc_" data-uid="Plugin_Everything.ShellContextMenu.WndProc*"></a>

  <h3 id="Plugin_Everything_ShellContextMenu_WndProc_System_Windows_Forms_Message__" data-uid="Plugin_Everything.ShellContextMenu.WndProc(System.Windows.Forms.Message@)">
  WndProc(ref Message)
  
  </h3>

  <div class="markdown level1 summary"><p>This method receives WindowMessages. It will make the &quot;Open With&quot; and &quot;Send To&quot; work
by calling HandleMenuMsg and HandleMenuMsg2. It will also call the OnContextMenuMouseHover
method of Browser when hovering over a ContextMenu item.</p>
</div>
  <div class="markdown level1 conceptual"></div>

  <div class="codewrapper">
    <pre><code class="lang-csharp hljs">protected override void WndProc(ref Message m)</code></pre>
  </div>

  <h4 class="section">Parameters</h4>
  <dl class="parameters">
    <dt><code>m</code> <a class="xref" href="https://learn.microsoft.com/dotnet/api/system.windows.forms.message">Message</a></dt>
    <dd><p>the Message of the Browser's WndProc</p>
</dd>
  </dl>













</article>



      </div>

      <div class="affix">
        <nav id="affix"></nav>
      </div>
    </main>

    <div class="container-xxl search-results" id="search-results"></div>

    <footer class="border-top text-secondary">
      <div class="container-xxl">
        <div class="flex-fill">
          <footer></footer>
        </div>
      </div>
    </footer>
  </body>
</html>
